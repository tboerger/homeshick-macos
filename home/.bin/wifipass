#!/bin/bash
set -e

SSID="$(sudo /System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport -I | sed -n "/ SSID:/s/^.\\{2,\\}: //p")"

if [ -n "$SSID" ]
then
  echo "$SSID"
  sudo security find-generic-password -ga "$SSID" 2>&1 >/dev/null | cut -d\" -f2
else
  echo "No current wifi network name detected" >&2
  exit 1
fi
